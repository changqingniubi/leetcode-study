## 并查集

### 什么是并查集： （合并，查找，集合）

+ 适合解决具有联通关系的问题。
+ 用于处理一些不相交集合的合并及查询问题。

**联通性**：

+ A -> B  +  B -> C    =>   A -> C   :  A联通B, B联通C, 推导出A联通C。
+ 联通性描述：x 和 y 是亲戚，y 和 z 是亲戚，那么我们就认定 x 和 z 也是亲戚。
  			如果 x, y是亲戚，那么 x的亲戚**都**是 y 的亲戚，y的亲戚也**都**是x的亲戚。

### 操作（维护联通性关系）

- **初始化**: 把每个节点所在集合初始化为其自身。
  	通常来说，这个步骤在每次使用该数据结构时只需要执行一次，无论何种实现方式，时间复杂度均为O(n)
- **合并**（Union）：把两个不相交的集合合并为一个集合。**链接的是两个集合**。
- **查询**：Find: 查询元素所在集合。 Query:  查询两个元素是否在同一个集合中

### 实现 + 优化

1. Quick-Find
   + 基于染色思想， 一开始所有节点颜色不同
   + 连接两个节点操作，看成将一种颜色染成另一种颜色
   + 如果两个节点颜色一样，证明是联通的，否则不是联通的

2. Quick-Union

   + 一种树型的数据结构。

   + **思想**: 
     是用一个数组表示了整片森林（parent），

     树的根节点唯一标识了一个集合，
     我们只要找到了某个元素的树根，就能确定它在哪个集合里。

   + 用递归的写法实现对代表元素的查询：一层一层访问父节点，直至根节点（根节点的标志就是父节点是本身）。
     要判断两个元素是否属于同一个集合，只需要看它们的根节点是否相同即可

   把集合比喻成**帮派**，而代表元素则是**帮主**。

   并查集的重要思想在于，**用集合中的一个元素代表集合**。

3. Weighted-Quick-Union

   查找： 和树高相关， 

   合并： 和树高相关

   结论：减少树高有助于提高查找效率

   思考： 

   1. 极端情况会退化成链表
   2. 按 树高 并还是 按秩（rank）合并更好？ （指标：平均查找次数 = 总查找次数 / 节点数）
      我们应该把简单的树往复杂的树上合并，而不是相反。因为这样合并后，到根节点距离变长的节点个数比较少。

4. 路径压缩的 Weighted-Quick-Union

   + 树结构中，树的具体结构并不重要

   + 扁平化管理

5. 模板代码 （只有路径压缩）

#### 路径压缩

​	有些人可能有一个误解，以为路径压缩优化后，并查集始终都是一个**菊花图**（只有两层的树的俗称）。但其实，由于路径压缩只在查询时进行，也只压缩一条路径，所以并查集最终的结构仍然可能是比较复杂的。

路径压缩和按秩合并如果一起使用，时间复杂度接近O(n) ，但是很可能会破坏rank（秩）的准确性。

###  特性

​	根节点的父节点是自己
​	具有传递性

### 场景

适合维护和查询联通关系的问题场景

## 算法题

#### 作业

+ 547省份数量
+ 200岛屿数量
+ 990等式⽅程的可满⾜性
+ 684冗余连接
+ 1319连通⽹络的操作次数

#### 延伸

+ 128最⻓连续序列

+ 947移除最多的同⾏或同列⽯头

+ 721账⼾合并

+ 765情侣牵⼿

+ 685冗余连接 II

参考链接： https://zhuanlan.zhihu.com/p/93647900/

